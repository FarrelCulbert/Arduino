#include <Wire.h> 
#include <LiquidCrystal_I2C.h> // Memasukkan perpustakaan LCD I2C

const int ldrPin = A0; // Pin LDR terhubung ke pin analog A0
const int ledPin = 6;  // Pin LED terhubung ke pin PWM 6

LiquidCrystal_I2C lcd(0x27, 16, 2); // Inisialisasi objek LCD I2C dengan alamat 0x27, 16 kolom, dan 2 baris

void setup() {
  pinMode(ledPin, OUTPUT);
  // Tidak perlu mengatur pinMode untuk pin analog (LDR)
  Serial.begin(9600); // Inisialisasi komunikasi serial untuk pemantauan nilai LDR
  lcd.begin();    // Inisialisasi LCD
  lcd.backlight();     // Hidupkan lampu latar LCD
}

void loop() {
  int ldrValue = analogRead(ldrPin); // Baca nilai LDR dari pin analog
  int pwmValue = map(ldrValue, 0, 1023, 0, 255); // Mapping nilai LDR ke rentang PWM (0-255)

  analogWrite(ledPin, pwmValue); // Atur intensitas LED menggunakan PWM

  Serial.print("{\"LDR\":");
  Serial.print(ldrValue);
  Serial.print(",\"PWM\":");
  Serial.print(pwmValue); 
  Serial.println("}");

  // Tampilkan nilai LDR dan PWM di LCD
  lcd.clear(); // Hapus tampilan sebelumnya
  lcd.setCursor(0, 0);
  lcd.print("LDR: ");
  lcd.print(ldrValue);
  lcd.setCursor(0, 1);
  lcd.print("PWM: ");
  lcd.print(pwmValue);

  delay(500); // Tunda agar tidak ada pembacaan berulang terlalu cepat
}
